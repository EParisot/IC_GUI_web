{% extends 'base.html' %}

{% block title %}Model{% endblock %}

{% block content %}

{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/style_model.css' %}" />

<div id="content_div">
	<div id="model_div" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
	<br>
	<p>Drag layers in your model:</p>
	<div id="tools_div">
		<div id="settings_div">
			
		</div>
		<div id="layers_div">
			<img id="in" src="{% static 'img/in_layer.png' %}" draggable="true" ondragstart="drag(event)" onclick="in_set(event)">
			<img id="dense" src="{% static 'img/dense.png' %}" draggable="true" ondragstart="drag(event)" onclick="dense_set(event)">
			<img id="conv2d" src="{% static 'img/conv2d.png' %}" draggable="true" ondragstart="drag(event)" onclick="conv2d_set(event)">
			<img id="flatten" src="{% static 'img/flatten.png' %}" draggable="true" ondragstart="drag(event)">
			<img id="max_pool" src="{% static 'img/max_pool.png' %}" draggable="true" ondragstart="drag(event)" onclick="max_pool_set(event)">
			<img id="dropout" src="{% static 'img/dropout.png' %}" draggable="true" ondragstart="drag(event)" onclick="dropout_set(event)">
			<img id="sig" src="{% static 'img/sig_activation.png' %}" draggable="true" ondragstart="drag(event)">
			<img id="softmax" src="{% static 'img/softmax_activation.png' %}" draggable="true" ondragstart="drag(event)">
			<img id="relu" src="{% static 'img/relu_activation.png' %}" draggable="true" ondragstart="drag(event)">
		</div>
		<div id="trash_div">
			<img id="trash" src="{% static 'img/trash.png' %}" ondrop="trash(event)" ondragover="allowDrop(event)">
		</div>
	</div>
</div>

<script>

//Set Sizes
var H = window.screen.height / 2;
var W = window.screen.width;

document.getElementById("model_div").style.width = W.toString()+'px';
document.getElementById("model_div").style.height = H.toString()+'px';
document.getElementById("layers_div").style.width = (W/2).toString()+'px';
document.getElementById("tools_div").style.width = (W).toString()+'px';

function allowDrop(ev) {
    ev.preventDefault();
}

function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
}

function drop(ev) {
    ev.preventDefault();
    var data = ev.dataTransfer.getData("text");
    ev.target.appendChild(document.getElementById(data).cloneNode(true));
	if (data == "in")
	{
		in_set(ev);
	}
	else if (data == "dense")
	{
		dense_set(ev);
	}
	else if (data == "conv2d")
	{
		conv2d_set(ev);
	}
	else if (data == "dropout")
	{
		dropout_set(ev);
	}
	else if (data == "max_pool")
	{
		max_pool_set(ev);
	}
}

function trash(ev) {
    ev.preventDefault();
    var data = ev.dataTransfer.getData("text");
	var elem = document.getElementById(data);
	if (elem.parentNode == document.getElementById("model_div"))
	{
		elem.parentNode.removeChild(elem); 
	}
}

function in_set(ev)
{
	if (ev.target.id == "model_div" || ev.target.parentNode.id == "model_div")
	{
		newWindow = window.open("in_layer", "In Layer settings", "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no");

	}
}

function conv2d_set(ev)
{
	if (ev.target.id == "model_div" || ev.target.parentNode.id == "model_div")
	{
		newWindow = window.open("conv2d_layer", "Conv2d Layer settings", "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no");

	}
}

function dense_set(ev)
{
	if (ev.target.id == "model_div" || ev.target.parentNode.id == "model_div")
	{
		newWindow = window.open("dense_layer", "Dense Layer settings", "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no");

	}
}

function max_pool_set(ev)
{
	if (ev.target.id == "model_div" || ev.target.parentNode.id == "model_div")
	{
		newWindow = window.open("max_pool_layer", "MaxPooling Layer settings", "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no");

	}
}

function dropout_set(ev)
{
	if (ev.target.id == "model_div" || ev.target.parentNode.id == "model_div")
	{
		newWindow = window.open("dropout_layer", " Layer settings", "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no");

	}
}

</script>

{% endblock %}